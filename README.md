# ModbusRTU_Master_MQTT_Gateway
–î–∞–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤—ã—Å—Ç—É–ø–∞–µ—Ç –º–∞—Å—Ç–µ—Ä–æ–º —Å–µ—Ç–∏ ModbusRTU. –û–±–º–µ–Ω–∏–≤–∞–µ—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏ —Å –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ (–¥–æ 247 —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ –ª–∏–Ω–∏–∏ RS485). –í—Å–µ –¥–∞–Ω–Ω—ã–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –ø–æ MQTT –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –≥–¥–µ –æ–Ω–∏ –º–æ–≥—É—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è, –∞ —Ç–∞–∫–∂–µ –ø–æ—è–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å —Å–µ—Ä–≤–µ—Ä–∞ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏. (–ü—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ —Ç—ã —ç—Ç–æ –≤—Å–µ –≤ —Å–∏–ª–∞—Ö —Å–∞–º –∑–∞–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞—Ç—å, –º–æ–π –¥—Ä—É–≥...).

### –û–ø–∏—Å–∞–Ω–∏–µ:
–û–±—â–µ–Ω–∏–µ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –ø–æ RS485. –°–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –¥–ª–∏–Ω–∞ –ª–∏–Ω–∏–∏ –º–æ–∂–µ—Ç –¥–æ—Ö–æ–¥–∏—Ç—å –¥–æ 1 –∫–º, –∞ –∏–∑–æ–ª—è—Ü–∏—è –ø–æ RS485 –¥–æ—Å—Ç–∏–≥–∞–µ—Ç 3000 –í. –ù–∞ —ç—Ç–æ–π –ª–∏–Ω–∏–∏ –º–æ–≥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Å—á–µ—Ç—á–∏–∫–∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–π —ç–Ω–µ—Ä–≥–∏–∏, –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∏, –∫–ª–∏–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–∞–º–µ—Ä—ã, –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä—ã, —â–∏—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ–≥–æ-–ª–∏–±–æ –∏ –º–Ω–æ–≥–æ —á–µ–≥–æ –¥—Ä—É–≥–æ–≥–æ. ModbusRTU –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å 1979 –≥–æ–¥–∞ –ø–æ —Å–µ–π –¥–µ–Ω—å –∏ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö —ç—Ç–æ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª –º–∏–ª–ª–∏–æ–Ω—ã.

### –ù–µ–º–Ω–æ–≥–æ –ø–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏:
–û—Å–Ω–æ–≤–Ω—É—é –∑–∞–¥–∞—á—É –ø–æ —Ä–∞–±–æ—Ç–µ —Å ModbusRTU –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è RISC-V –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä CH32V203F8P6. –ù–∞ –Ω–µ–º –∑–∞–¥–∞–Ω—ã —Ç–∞–π–º–∏–Ω–≥–∏ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏ –Ω–∞–ø–∏—Å–∞–Ω–∞ —Å–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ModbusRTU Master. –í—Å–µ –Ω–∞–ø–∏—Å–∞–Ω–æ –Ω–∞ RVMSIS. –û—Ç–ª–∏—á–Ω—ã–π, –æ—á–µ–Ω—å –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –∫–∞–º—É—à–µ–∫ —Å –¥–≤—É–º—è UART –Ω–∞ –±–æ—Ä—Ç—É. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∏–Ω—É—Å –¥–∞–Ω–Ω–æ–≥–æ –ú–ö - –æ–Ω –Ω–µ –∏–º–µ–µ—Ç –≤—Ö–æ–¥–∞ –∫–≤–∞—Ä—Ü–µ–≤–æ–≥–æ —Ä–µ–∑–æ–Ω–∞—Ç–æ—Ä–∞, –ø–æ—ç—Ç–æ–º—É —Å–∏–ª—å–Ω–æ –∑–∞–¥–∏—Ä–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å UART –Ω–µ —Å—Ç–∞–ª –±—ã. –û–±—ã—á–Ω–æ–≥–æ 9600 - 115200 —Ö–≤–∞—Ç–∏—Ç. –ü–æ–∫–∞ —Ç–µ—Å—Ç–∏—Ä—É—é –Ω–∞ 9600. –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ —Å–±–æ–µ–≤.
–ü–æ —á–∞—Å—Ç–∏ WIFI - –∑–¥–µ—Å—å —Ä–∞—Å–ø–∞—è–Ω WiFi –º–æ–¥—É–ª—å –Ω–∞ –±–∞–∑–µ –æ–¥–Ω–æ–∫—Ä–∏—Å—Ç–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã (SoC) ESP8266. –ù–∞–ø–∏—Å–∞–Ω–æ —Å–≤–æ–µ –ü–û –¥–ª—è –º–æ–¥—É–ª—è, —á—Ç–æ –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ WIFI MQTT —à–ª—é–∑–∞. –û–±—â–µ–Ω–∏–µ —Å CH32V203F8P6 –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ USART –ø–æ —Å–∞–º–æ–ø–∏—Å–Ω–æ–º—É –ø—Ä–æ—Ç–æ–∫–æ–ª—É, –∫–æ—Ç–æ—Ä—ã–º —è –ø–æ–ª—å–∑—É—é—Å—å —É–∂–µ 3 –≥–æ–¥–∞ –±–µ–∑ —Å–±–æ–µ–≤.
–ú–Ω–æ–≥–∏–µ, –∫—Ç–æ –≤ —Ç–µ–º–µ –∑–∞–¥–∞—Å—Ç –æ—á–µ—Ä–µ–¥–Ω–æ–π –≤–æ–ø—Ä–æ—Å, –ø–æ—á–µ–º—É –≤—Å—é —Ä–∞–±–æ—Ç—É –Ω–µ –æ—Å—É—â–µ—Å—Ç–≤–∏—Ç—å –Ω–∞ ESP8266? –û—Ç–≤–µ—á–∞—é: —è –Ω–µ –∑–Ω–∞—é –Ω–∞ —Å—Ç–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ ES8266, —á—Ç–æ–± –¥–æ–≤–µ—Ä–∏—Ç—å –µ–π —Ä–∞–±–æ—Ç—É —Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏, —Ç–∞–π–º–µ—Ä–∞–º–∏ –∏ –ø—Ä–æ—á–∏–º. –°–∏—Å—Ç–µ–º–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π —è —Ä–∞–±–æ—Ç–∞—é - –æ–±–∫–∞—Ç–∞–Ω–∞ –≥–æ–¥–∞–º–∏. –ú–µ–Ω—è—Ç—å –ø–æ–∫–∞ –Ω–µ —Å–æ–±–∏—Ä–∞—é—Å—å.

### –ü–æ –∫–æ—Ä–ø—É—Å—É:
–û—á–µ–Ω—å —Ö–æ—Ç–µ–ª–æ—Å—å –≤—ã–ø–µ–Ω–¥—Ä–∏—Ç—å—Å—è –∏ —É–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ –≤ –∫–æ—Ä–ø—É—Å –Ω–∞ DIN —Ä–µ–π–∫—É –∏ —á—Ç–æ–± 1 –º–æ–¥—É–ª—å –∑–∞–Ω–∏–º–∞–ª–æ –≤—Å–µ–≥–æ –ª–∏—à—å. –ò–∑ –∑–∞ —ç—Ç–æ–≥–æ –º—ã –≤–∏–¥–∏–º –∞–Ω—Ç–µ–Ω–Ω—É, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ–º–Ω–æ–≥–æ –º–µ—à–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å RS485 (GND), –Ω–æ –æ–ø—è—Ç—å –∂–µ....–∫–∞–∫ —á–∞—Å—Ç–æ –º—ã GND —Ç—É–¥–∞ –ø–æ–¥—Ü–µ–ø–ª—è–µ–º?) –ù–∞ 80% —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –æ–Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ.
DCDC –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª–µ–º, —á—Ç–æ–± –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–∏—Ç–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –æ—Ç 12-24–í —Ç–æ–∂–µ –ø—Ä–∏—à–ª–æ—Å—å –ø–æ–∂–µ—Ä—Ç–≤–æ–≤–∞—Ç—å, –Ω–µ–≥–¥–µ –µ–≥–æ —Ç–∞–º —Ä–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –≤–Ω—É—Ç—Ä–∏). –ü–æ—ç—Ç–æ–º—É –ø–∏—Ç–∞–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ—Ç 5–í. –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª—é—Å–æ–≤–∫–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
–ù–µ –∑–Ω–∞–ª, –∫–∞–∫ –ø–æ—Å—Ç—É–ø–∏—Ç—å —Å –ø–æ—Ä—Ç–æ–º –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞. –ù–∞ –ª–∏—Ü–µ–≤—É—é —Å—Ç–æ—Ä–æ–Ω—É —Ç—è–∂–µ–ª–æ —É–∂–µ –±—ã–ª–æ –≤—ã–≤–µ—Å—Ç–∏, –ø–æ—ç—Ç–æ–º—É –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å –æ–∫–æ—à–∫–æ –≤ –∫–æ—Ä–ø—É—Å–µ —Å–ø—Ä–∞–≤–∞. –û—Ç–∫—Ä—ã–ª - –∑–∞–ø—Ä–æ–≥–∞–ª - –∑–∞–∫—Ä—ã–ª.

### –ü–æ –¥–∏–∑–∞–π–Ω—É:
–í—Å–µ –≤ —Ç—Ä–∞–¥–∏—Ü–∏—è—Ö –Ω–∞—à–µ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è) –ù–µ–º–Ω–æ–≥–æ —É—Ä–æ–¥–ª–∏–≤–æ, –∑–∞—Ç–æ —Å –¥—É—à–æ–π –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±—é–¥–∂–µ—Ç–Ω–æ üòÅ

### –ù—É –∏ –Ω–µ –∑–∞–±—ã–≤–∞–µ–º, —á—Ç–æ –≤—Å–µ –¥–µ–ª–∞–ª–æ—Å—å –≤ –¥–æ–º–∞—à–Ω–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö)

![1](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/15267bd0-a422-40ee-a7ec-8b2134709655)
![2](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/f1cf966f-ec3e-49e8-8ede-3d8c99f5affc)
![3](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/55986997-2bbd-433c-ba5a-64307e9afe8e)
![4](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/ffc6348d-9f7e-477a-8563-bffc0eeb7133)
![5](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/1424d8b4-ffbd-4cc6-a362-71cc3b3421c4)
![6](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/cf1ffb8d-9075-4697-bd86-ee3f18c456cd)
![7](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/79cdf27c-4561-4f18-bb87-1eedf366790a)
![8](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/0d98ccff-5385-4799-9426-b0fcffa4269b)
![9](https://github.com/Solderingironspb/ModbusRTU_Master_MQTT_Gateway/assets/68805120/df3055cc-2817-4832-a069-42d4c9a20997)

